<!doctype html>
<html>

<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
    crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="css/animate.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/holder/2.9.4/holder.js"></script>
  <title>Socket.IO chat</title>
  <style>
    .card {
      cursor: pointer;
      background-color: rgb(50, 50, 243);
      color: white;
      height: 100px;
      -webkit-transition: background-color 0.3s ease-out;
      -ms-transition: background-color 0.3s ease-out;
      transition: background-color 0.3s ease-out;
    }

    .disabled {
      background-color: rgb(158, 156, 156);
      cursor: disabled;
    }
  </style>
</head>

<body>
  <h2>Hallo Sch√§tzchen</h2>
  <h2 id="name"></h2>
  <div class="container">
    <div class="row align-items-center" id="card-deck"></div>
  </div>

  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    $(function () {
      var sizes = ['Training', 'Amateur', 'Semi-Pro', 'Pro', 'World-Class', 'Legendary'];
      var socket = io();

      var username = "";
      if (!localStorage['name']) {
        var person = prompt("Please enter your name", "Harry Potter");
        localStorage['name'] = person;
      } else {
        person = localStorage['name'];
      }
      $('#name').html(person);

      if (!localStorage['imageUrl']) {
        var urlPrompt = prompt("enter your avatar image", "https://media.giphy.com/media/xUNd9FzxmXhhaD3tvO/200w_d.gif");
        localStorage['imageUrl'] = urlPrompt;
      } else {
        urlPrompt = localStorage['imageUrl'];
      }

      var roomCode = prompt("enter room code", "12345");
      if (roomCode) {
        socket.emit('room', roomCode);
      }

      socket.on('chef connected', function () {
        alert("chef ist da");
        socket.emit('room', roomCode);
      });

      socket.on('chat message', function (msg) {
        $('#messages').append($('<li>').text(msg));
        window.scrollTo(0, document.body.scrollHeight);
      });

      function drawCards(sizes) {
        $('#card-deck').empty();
        $.each(sizes, function (index, size) {
          $('#card-deck').append(
            '<div class="col-md-2 col-sm-4 col-6">\
            <div class="card" data-value="' + size + '" data-clickable="true">\
              <div class="card-block">\
              <h4 class="card-title">'+ size + '</h4>\
              </div>\
            </div>\
          </div > '
          )
        });
        $('.card').click(function (item) {
          if ($(this).data('clickable') === true) {
            $('.card').data('clickable', false);
            var name = person;
            var card_value = $(this).data("value");
            var data = { "name": name, "card_value": card_value, "url": urlPrompt };
            socket.emit('card draw', data);
            $('.card:not([data-value="' + card_value + '"]').addClass('disabled');
          }
        });
      }

      drawCards(sizes);



      socket.on('card reset', function () {
        drawCards(sizes);
      });

    });
  </script>
</body>

</html>